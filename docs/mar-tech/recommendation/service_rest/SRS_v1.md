Версия 1.0

> **Область:** Документ описывает Решение v1.0 — стратегии 1 (коллаборативная фильтрация) и 2 (по категории соцсети). v2.0 (МСБ, сегментация, композит) — отдельный scope.

# Бизнес требования

Создать систему рекомендаций конкурентов, чтобы пользователи видели рекомендуемые аккаунты и могли добавлять их к себе на дашборд. Цель — больше аккаунтов → выше тариф.

# Глоссарий

| Термин | Определение |
|--------|-------------|
| **Аккаунт** | Профиль в социальной сети (Instagram, YouTube и др.), принадлежащий пользователю или конкуренту |
| **Дашборд** | Рабочее пространство пользователя с добавленными аккаунтами для мониторинга |
| **Конкурент** | Аккаунт, похожий на аккаунты пользователя (по категории, поведению пользователей и т.п.) |
| **Виджет** | Блок интерфейса с рекомендуемыми аккаунтами и кнопкой «Добавить на дашборд» |
| **Стратегия** | Алгоритм подбора рекомендаций (коллаборативная фильтрация, по категории и др.) |

# Бизнес правила

| ID | Правило |
|----|---------|
| BR-001 | Стратегия 1. Коллаборативная фильтрация. Использование известных предпочтений группы пользователей для прогнозирования неизвестных предпочтений другого пользователя. Для общего списка. |
| BR-002 | Стратегия 2. По категории соцсети (если аккаунты одной соцсети). Для дашборда выбранного аккаунта. |
| BR-003 | Не показывать аккаунты, которые уже есть у Пользователя. |
| BR-004 | Сортировать по подписчикам, чем больше, тем выше (левее). |
| BR-005 | При пустом результате не выводить виджет в обоих стратегиях. |

# Роли

| Роль | Описание |
|------|----------|
| **Сервис** | REST API, реализующий алгоритм подборки рекомендаций (бэкенд) |
| **Клиент** | Веб-приложение (фронтенд) |
| **Пользователь** | Владелец дашборда с аккаунтами соцсетей своих/чужих |


# Пользовательские требования

| ID | Требование |
|----|------------|
| UR-001 | В общем списке аккаунтов Клиента должен отображаться виджет с рекомендуемыми аккаунтами по Стратегии 1. |
| UR-002 | На дашборде выбранного аккаунта должен отображаться виджет с рекомендуемыми аккаунтами по Стратегии 2. |

# Функциональные

| ID | Требование |
|----|------------|
| FR-001 | Виджет для всех стратегий должен быть одинаковый. |
| FR-002 | При ошибке загрузки (сеть, таймаут) данных виджет скрывается. |
| FR-003 | Виджет при загрузке должен отображать стандартный лоадер-скелетон, пока данные не подгрузились. |
| FR-004 | У аккаунтов должна быть кнопка «Добавить аккаунт на дашборд». |
| FR-005 | Если аккаунт не может быть добавлен, то должно выводиться сообщение о причине (сеть недоступна, не позволяет тариф, аккаунт уже добавлен). |
| FR-006 | Если аккаунт уже добавлен (на другой вкладке), то этот аккаунт должен скрываться. |
| FR-007 | Если при добавлении аккаунта требуется переключиться на тариф выше, то должно выводиться предупреждение. |
| FR-008 | Если пользователь подтвердил смену тарифа, то сначала меняется тариф и только потом добавляется аккаунт. |
| FR-009 | Добавленный аккаунт должен исчезать из списка после успешного ответа от сервера. |
| FR-010 | После добавления аккаунта список должен фоново обновиться с Сервиса. |
| FR-011 | Если аккаунтов не осталось, то виджет должен скрываться. |
| FR-012 | Если достигнут лимит на добавление аккаунта, то кнопка «Добавить на дашборд» должна остаться видимой, но при клике показывать сообщение о лимите. |
| FR-013 | Перед добавлением аккаунта на дашборд необходимо проверить тариф и его лимиты. |

# Нефункциональные

| ID | Требование |
|----|------------|
| NFR-001 | Сервис должен выдавать список не более чем за 1 секунду. |
| NFR-002 | Если Сервис возвращает ошибку 401, то на Клиенте должна сработать переадресация на страницу входа. |

# Ограничения

| ID | Ограничение |
|----|-------------|
| CON-001 | Максимум 50 аккаунтов в ответе (параметр limit 1–50, по умолчанию 10). |
| CON-002 | Не показывать технические ошибки (сеть, сервер). Бизнес-ограничения (лимит тарифа, дубликат) отображать пользователю в виде понятных сообщений. |
| CON-003 | Если список пуст или есть ошибки, то виджет не должен выводиться и занимать место на экране. |

# Контракты и интеграции

- [OpenAPI v1](openapi_v1.yaml) — эндпоинт `GET /api/v1/account_recommendation`. Параметры: algo (PBUW, CATG), social, socialId, simple, limit, debug. Добавление аккаунта на дашборд — в другом сервисе (api-statistics предоставляет только список рекомендаций).

# ER-диаграмма

# Use Cases диаграмма

# Sequence диаграмма

- [sequence.puml](diagramm/sequence.puml) — загрузка рекомендаций (UR-001, UR-002), стратегии 1 и 2.
