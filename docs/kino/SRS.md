# Бизнес требования

Цель: обеспечить стабильные онлайн‑продажи билетов 24/7 и снизить нагрузку на кассы за счет самостоятельной покупки пользователями.

## Бизнес-правила и ограничения

| ID | Правило |
|----|---------|
| BR-001 | Соблюдать возрастной ценз. Например, билеты на фильмы 18+ могут приобретать только совершеннолетние. |
| BR-002 | Конфигурации и количества залов у каждого кинотеатра свои. |
| BR-003 | Отмена покупки невозможна за 10 минут до начала сеанса. |
| BR-004 | Нельзя допускать продажи одних и тех же мест. |
| BR-005 | Билет должен быть связан с Покупателем. |

## Роли

| Роль | Описание |
|------|----------|
| **Покупатель** | Любой желающий |
| **Система оплаты** | Внешний API для оплаты |
| **Сервис уведомлений** | Отправка SMS со ссылкой на билет |

# Пользовательские требования

| ID | Требование |
|----|------------|
| UR-001 | Поиск фильма по названию, времени, жанру. |
| UR-002 | Информация о фильме и его расписание. |
| UR-003 | План зала, свободные места и стоимость. |
| UR-004 | Оплата билетов по безналичному расчёту. |
| UR-005 | Просмотр истории покупок. |
| UR-006 | Отмена покупки. |

# Функциональные требования

| ID | Требование |
|----|------------|
| FR-001 | Предоставить информацию о фильме, кинотеатре, расписании, свободных местах и стоимости. |
| FR-002 | Места, которые выбрал Покупатель, должны бронироваться. |
| FR-003 | Время бронирования мест: 10 минут. |
| FR-004 | Забронированные места должны быть недоступны для покупки, пока их не оплатят или не выйдет время таймера. |
| FR-005 | Купленные места должны быть заблокированы для других Покупателей. |
| FR-006 | По окончании времени, отведённого Покупателю, нужно обновить данные зала и начать отсчёт заново. |
| FR-007 | Время на оплату ограничено — 5 минут. |
| FR-008 | Оплаченные билеты нельзя отменить за 10 минут до начала сеанса. |
| FR-009 | Отправить билет (код билета) только после подтверждения оплаты банком. |
| FR-010 | Подтверждение возраста, если есть ценз. |
| FR-011 | Запоминать Покупателя и его номер телефона. |
| FR-012 | История покупок Покупателя. |
| FR-013 | Уведомления о покупке (SMS). |

# Нефункциональные требования

| ID | Требование |
|----|------------|
| NFR-001 | Доступность должна быть на уровне 99,5% по времени бизнеса 9–21. |
| NFR-002 | Производительность: поиск < 500 ms p95, покупка < 2 сек с p95. |
| NFR-003 | Безопасность: PCI-DSS для платежей (не храним данные карты), защита PII для ПДн (шифрование телефона). |
| NFR-004 | Логируемость (поиск, резерв, покупка, выдача) и трассировка критических операций (сквозное отслеживание запроса). |
| NFR-005 | Система должна хранить данные Покупателя в соответствии с требованиями к ПДн. |

# Ограничения

| ID | Ограничение |
|----|-------------|
| CON-001 | Все платежи идут через внешнего провайдера. |
| CON-002 | Схема зала фиксированная и не меняется часто. |

# Диаграмма последовательности (Sequence-diagram)

- [Покупка билетов](diagramm/buy_tickets.puml)
- [Покупка билетов (cache + строгая консистентность)](diagramm/kiosk.puml)

# Use Case диаграмма

- [Покупка билетов](diagramm/usecases.puml)

# Контракты и интеграции

- [OpenAPI (Swagger)](openapi.yaml) — описание эндпоинтов по sequence.puml и SRS.

# Модель данных (ER-diagram)

# Телеметрия

